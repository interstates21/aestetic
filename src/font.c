/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   font.c                                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: bdeomin <bdeomin@student.42.fr>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/10/22 09:18:24 by vslutiak          #+#    #+#             */
/*   Updated: 2019/10/29 21:49:18 by bdeomin          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../includes/doom_nukem.h"

static void	s(int arr[8], t_bitmap *b)
{
	int		i;

	i = -1;
	while (++i < 8)
		b->bit[i] = arr[i];
}

static void	part_w(t_env *d)
{
	s((int[8]){0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0x7e, 0x3c}, &d->chars.v);
	s((int[8]){0xc3, 0xc3, 0xdb, 0xdb, 0xdb, 0xff, 0x7e, 0xaa}, &d->chars.w);
	s((int[8]){0xe7, 0xe7, 0x7e, 0x3c, 0x3c, 0x7e, 0xe7, 0xe8}, &d->chars.x);
	s((int[8]){0xe7, 0xe7, 0x7e, 0x3c, 0x3c, 0x7c, 0xe0, 0xe0}, &d->chars.y);
	s((int[8]){0xe7, 0xf7, 0xf7, 0xff, 0xff, 0xff, 0xef, 0xe7}, &d->chars.z);
	s((int[8]){0, 0, 0, 0, 0, 0, 0x18, 0x18}, &d->chars.dot);
	s((int[8]){0, 0, 0, 0, 0, 0, 0}, &d->chars.spc);
	s((int[8]){0, 0x18, 0x18, 0, 0, 0x18, 0x18, 0}, &d->chars.semi);
	s((int[8]){0x7e, 0xff, 0xe7, 0xe7, 0xe7, 0xe7, 0xff, 0x7e}, &d->chars.n0);
	s((int[8]){0x38, 0x78, 0xf8, 0x38, 0x38, 0x38, 0x38, 0x38}, &d->chars.n1);
	s((int[8]){0x7e, 0xff, 0xe7, 0x0e, 0x38, 0xe0, 0xff, 0xff}, &d->chars.n2);
	s((int[8]){0xfe, 0xff, 0x07, 0xfe, 0xfe, 0x07, 0xff, 0xfe}, &d->chars.n3);
	s((int[8]){0xee, 0xee, 0xee, 0xff, 0xff, 0x0e, 0x0e, 0x0e}, &d->chars.n4);
	s((int[8]){0xff, 0xff, 0xe0, 0xfe, 0xff, 0x07, 0xff, 0x7e}, &d->chars.n5);
	s((int[8]){0x7e, 0xff, 0xe0, 0xfe, 0xff, 0xe7, 0xff, 0x7e}, &d->chars.n6);
	s((int[8]){0xff, 0xff, 0x07, 0x0e, 0x1c, 0x38, 0x38, 0x38}, &d->chars.n7);
	s((int[8]){0x7e, 0xff, 0xe7, 0x7e, 0x7e, 0xe7, 0xff, 0x7e}, &d->chars.n8);
	s((int[8]){0x7e, 0xff, 0xe7, 0xff, 0x7f, 0x07, 0xff, 0x7e}, &d->chars.n9);
	s((int[8]){0x0c, 0x0c, 0x18, 0x18, 0x30, 0x30, 0x60, 0x60}, &d->chars.slh);
	s((int[8]){0x66, 0x66, 0x0c, 0x0c, 0x18, 0x18, 0x33, 0x33}, &d->chars.prc);
	s((int[8]){0x18, 0x18, 0x18, 0x18, 0, 0x18}, &d->chars.exc);
}

void		font_initialize(t_env *d)
{
	*d = (t_env){.chars.a.bit = {0x7e, 0xff, 0xe7, 0xe7, 0xff, 0xff, 0xe7,
								0xe7},
			.chars.b.bit = {0xfe, 0xff, 0xe7, 0xfe, 0xfe, 0xe7, 0xff, 0xfe},
			.chars.c.bit = {0x7e, 0xff, 0xe7, 0xe0, 0xe0, 0xe7, 0xff, 0x7e},
			.chars.d.bit = {0xfe, 0xff, 0xe7, 0xe7, 0xe7, 0xe7, 0xff, 0xfe},
			.chars.e.bit = {0xff, 0xff, 0xe0, 0xfc, 0xfc, 0xe0, 0xff, 0xff},
			.chars.f.bit = {0xff, 0xff, 0xe0, 0xfc, 0xfc, 0xe0, 0xe0, 0xe0},
			.chars.g.bit = {0x7e, 0xff, 0xe7, 0xe0, 0xef, 0xe7, 0xff, 0x7e},
			.chars.h.bit = {0xe7, 0xe7, 0xe7, 0xff, 0xff, 0xe7, 0xe7, 0xe7},
			.chars.i.bit = {0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c},
			.chars.j.bit = {0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0xfc, 0xf8},
			.chars.k.bit = {0xe3, 0xe7, 0xee, 0xfc, 0xfc, 0xee, 0xe7, 0xe3},
			.chars.l.bit = {0xe0, 0xe0, 0xe0, 0xe0, 0xe0, 0xe0, 0xff, 0xff},
			.chars.m.bit = {0xc3, 0xe7, 0xff, 0xff, 0xe7, 0xe7, 0xe7, 0xe7},
			.chars.n.bit = {0xe7, 0xf7, 0xf7, 0xff, 0xff, 0xff, 0xef, 0xe7},
			.chars.o.bit = {0x7e, 0xff, 0xe7, 0xe7, 0xe7, 0xe7, 0xff, 0x7e},
			.chars.p.bit = {0xfe, 0xff, 0xe7, 0xff, 0xfe, 0xe0, 0xe0, 0xe0},
			.chars.q.bit = {0x7e, 0xff, 0xc7, 0xc7, 0xc3, 0xd9, 0xec, 0x63},
			.chars.r.bit = {0xfe, 0xff, 0xe7, 0xff, 0xfe, 0xe7, 0xe7, 0xe7},
			.chars.s.bit = {0x7e, 0xff, 0xe0, 0xfe, 0x7f, 0x07, 0xff, 0x7e},
			.chars.t.bit = {0xfe, 0xfe, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38},
			.chars.u.bit = {0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0xff, 0x7e}};
	part_w(d);
}

void		draw_bitmap(t_env *d, t_bitmap bitmap, int x, int y)
{
	int		i;
	int		j;

	j = -1;
	while (++j < 8)
	{
		i = -1;
		while (++i < 9)
		{
			if ((bitmap.bit[j] >> (8 - i)) & 1)
				pixel_put(d, new_v3(x + i, y + j, 0), 0xffffff, 0);
		}
	}
}

void		displaing_str(t_env *d, t_font f)
{
	int		x_start;

	x_start = f.x;
	while (*f.str)
	{
		draw_char(d, f);
		f.x += 10;
		f.str++;
		if (*f.str == '\n' && ((f.x = x_start) == x_start) && f.str++)
			f.y += 36;
	}
}
