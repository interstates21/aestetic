#include "../includes/doom_nukem.h"

void	draw_cha(t_data *d, t_font *f)
{
	int		i;
	int		j;
	char	c;
	int		y;

	c = *f->str & 0x7F;
	if (c < ' ')
		c = 0;
	else
		c -= ' ';
	j = -1;
	while (++j < CHAR_WIDTH * f->scale)
	{
		i = -1;
		y = SPECIAL_CHAR(*f->str) ? 2 * f->scale : 0;
		while (++i < CHAR_HEIGHT * f->scale)
			if (d->font[(int)c][j / f->scale] & (1 << i / f->scale))
			{
				putpixel(d, f->x + j, f->y + i + y, f->color);
				putpixel(d, f->x + j, f->y + i + y + f->scale, 0xffffff);
			}
	}
}


void	draw_char(t_data *d, t_font *f)
{
	int		i;
	int		j;
	char	c;
	int		y;
	t_chars t = (t_chars){.c = {{0x7e, 0xff, 0xe7, 0xe7, 0xff, 0xff, 0xe7, 0xe7},
			{0xfe, 0xff, 0xe7, 0xfe, 0xfe, 0xe7, 0xff, 0xfe}, {0x7e, 0xff, 0xe7, 0xe0,
															   0xe0, 0xe7, 0xff, 0x7e}, {0xfe, 0xff, 0xe7, 0xe7, 0xe7, 0xe7, 0xff, 0xfe},
			{0xff, 0xff, 0xe0, 0xfc, 0xfc, 0xe0, 0xff, 0xff}, {0xff, 0xff, 0xe0, 0xfc,
															   0xfc, 0xe0, 0xe0, 0xe0}, {0x7e, 0xff, 0xe7, 0xe0, 0xef, 0xe7, 0xff, 0x7e},
			{0xe7, 0xe7, 0xe7, 0xff, 0xff, 0xe7, 0xe7, 0xe7}, {0x2f, 0x2f, 0x00, 0x2f,
															   0x2f, 0x2f, 0x2f, 0x2f}, {0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0x1c, 0xfc, 0xf8},
			{0xe3, 0xe7, 0xee, 0xfc, 0xfc, 0xee, 0xe7, 0xe3}, {0xe0, 0xe0, 0xe0, 0xe0,
															   0xe0, 0xe0, 0xff, 0xff}, {0xc3, 0xe7, 0xff, 0xff, 0xe7, 0xe7, 0xe7, 0xe7},
			{0xe7, 0xf7, 0xf7, 0xff, 0xff, 0xff, 0xef, 0xe7}, {0x7e, 0xff, 0xe7, 0xe7,
															   0xe7, 0xe7, 0xff, 0xe7}, {0xfe, 0xff, 0xe7, 0xff, 0xfe, 0xe0, 0xe0, 0xe0},
			{0x7e, 0xff, 0xc7, 0xc7, 0xc3, 0xd9, 0xfc, 0x73}, {0xfe, 0xff, 0xe7, 0xff,
															   0xfe, 0xe7, 0xe7, 0xe7}, {0x7e, 0xff, 0xe0, 0xfe, 0x7f, 0x07, 0xff, 0x7e},
			{0xfe, 0xfe, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38}, {0xe7, 0xe7, 0xe7, 0xe7,
															   0xe7, 0xe7, 0xff, 0x7e}, {0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0xe7, 0x7e, 0x3c},
			{0xc3, 0xc3, 0xdb, 0xdb, 0xdb, 0xff, 0x7e, 0xaa}, {0xe7, 0xe7, 0x7e, 0x3c,
															   0x3c, 0x7e, 0xe7, 0xe8}, {0xe7, 0xe7, 0xe7, 0x7e, 0x3c, 0x18, 0x18, 0x18},
			{0xff, 0xff, 0x0f, 0x1e, 0x78, 0xf0, 0xff, 0xff}, {0, 0x18, 0x18, 0, 0,
															   0x18, 0x18, 0}, {0x1c, 0x1c, 0x1c, 0x1c, 0, 0, 0x1c, 0x1c}}};

	d->f = t;
	c = *f->str & 0x7f;
	c = ft_toupper(c) - 'A';
	j = -1;
	while (++j < 8)
	{
		i = 0;
		while (++i < 8)
			if ((d->f.c[c][j] >> (7 - i)) & 1)
				putpixel(d, f->x + i, f->y + j, 0xffffff);
	}
}

void	draw_string(t_data *d, t_font f)
{
	int			x_start;

	x_start = f.x;
	while (*f.str)
	{
		draw_char(d, &f);
		f.x += (CHAR_WIDTH + 1) * f.scale;
		f.str++;
		if (*f.str == '\n' && ((f.x = x_start) == x_start) && f.str++)
			f.y += (CHAR_HEIGHT + 10) * f.scale;
	}
}
